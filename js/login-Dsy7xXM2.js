import{i as d,a as u,b as f,c as p}from"./isResponseError-BKjdF__d.js";import{S as h,d as r}from"./displayError-qDOzf5us.js";function S(){const a="form",o='button[type="submit"]',t=document.querySelector(a),e=document.querySelector(o);if(!d(t,a)||!d(e,o))return;const i=new h(e);t.addEventListener("submit",c=>{var l;c.preventDefault(),t.classList.remove("validation-error"),(l=document.querySelector(".error"))==null||l.classList.add("hide"),setTimeout(()=>{var n;(n=document.querySelector(".error"))==null||n.remove()},200);const m=new FormData(t),s={};for(const n of m.entries())s[n[0]]=n[1];i.disable(),i.showLoader(),setTimeout(()=>{y(s,t,i)},400)})}async function y(a,o,t){fetch("http://localhost:4000/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(async e=>{if(!e.ok)throw t.enable(),t.hideLoader(),await e.json();return e.json()}).then(e=>{t.enable(),t.hideLoader(),localStorage.setItem("token",e),window.location.replace("/hjort-cms/bokningar/")}).catch(e=>{u(e)?e.field==="login"?(o.classList.add("validation-error"),r(o,"Felaktigt användarnamn eller lösenord.")):e.field==="network"&&(o.classList.add("validation-error"),r(o,"Det uppstod ett nätverksfel. Försök igen senare.")):(o.classList.add("validation-error"),r(o,"Unexpected app error"))})}function L(){f(),p(),S()}L();
