import{i as d,a as f,b as h,c as p}from"./isResponseError-eh5yk8Zt.js";import{S as u,d as i}from"./displayError-qDOzf5us.js";function L(){const a="form",o='button[type="submit"]',e=document.querySelector(a),t=document.querySelector(o);if(!d(e,a)||!d(t,o))return;const r=new u(t);e.addEventListener("submit",c=>{var l;c.preventDefault(),e.classList.remove("validation-error"),(l=document.querySelector(".error"))==null||l.classList.add("hide"),setTimeout(()=>{var n;(n=document.querySelector(".error"))==null||n.remove()},200);const m=new FormData(e),s={};for(const n of m.entries())s[n[0]]=n[1];r.disable(),r.showLoader(),setTimeout(()=>{S(s,e,r)},400)})}async function S(a,o,e){fetch("http://localhost:4000/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(async t=>{if(!t.ok)throw e.enable(),e.hideLoader(),await t.json();return t.json()}).then(t=>{e.enable(),e.hideLoader(),localStorage.setItem("token",t),window.location.replace("/hjort-cms/bokningar/")}).catch(t=>{e.enable(),e.hideLoader(),f(t)?t.field==="login"?(o.classList.add("validation-error"),i(o,"Felaktigt användarnamn eller lösenord.")):t.field==="network"&&(o.classList.add("validation-error"),i(o,"Det uppstod ett nätverksfel. Försök igen senare.")):(o.classList.add("validation-error"),i(o,"Unexpected app error"))})}function y(){h(),p(),L()}y();
