import{i as l,a as f,b as u,c as h}from"./isResponseError-eh5yk8Zt.js";import{S as p,d as i}from"./displayError-qDOzf5us.js";function L(){const a="form",n='button[type="submit"]',e=document.querySelector(a),t=document.querySelector(n);if(!l(e,a)||!l(t,n))return;const r=new p(t);e.addEventListener("submit",c=>{var d;c.preventDefault(),e.classList.remove("validation-error"),(d=document.querySelector(".error"))==null||d.classList.add("hide"),setTimeout(()=>{var o;(o=document.querySelector(".error"))==null||o.remove()},200);const m=new FormData(e),s={};for(const o of m.entries())s[o[0]]=o[1];r.disable(),r.showLoader(),setTimeout(()=>{S(s,e,r)},400)})}async function S(a,n,e){fetch("https://hjort-backend.azurewebsites.net/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}).then(async t=>{if(!t.ok)throw e.enable(),e.hideLoader(),await t.json();return t.json()}).then(t=>{e.enable(),e.hideLoader(),localStorage.setItem("token",t),window.location.replace("/hjort-cms/bokningar/")}).catch(t=>{e.enable(),e.hideLoader(),f(t)?t.field==="login"?(n.classList.add("validation-error"),i(n,"Felaktigt användarnamn eller lösenord.")):t.field==="network"&&(n.classList.add("validation-error"),i(n,"Det uppstod ett nätverksfel. Försök igen senare.")):(n.classList.add("validation-error"),i(n,"Unexpected app error"))})}function y(){u(),h(),L()}y();
