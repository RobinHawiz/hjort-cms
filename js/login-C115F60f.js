import{i as l,a as b,b as h,c as m}from"./isResponseError-D5BMWoZH.js";class f{constructor(e){this.button=e}showLoader(){this.button.classList.add("loading")}hideLoader(){this.button.classList.remove("loading")}enable(){this.button.disabled=!1,this.updateAriaDisabled()}disable(){this.button.disabled=!0,this.updateAriaDisabled()}updateAriaDisabled(){this.button.setAttribute("aria-disabled",this.button.disabled.toString())}}function s(n,e){const t=document.createElement("p");t.setAttribute("class","error"),t.innerText=e,n.insertBefore(t,n.firstChild)}function p(){const n="form",e='button[type="submit"]',t=document.querySelector(n),i=document.querySelector(e);if(!l(t,n)||!l(i,e))return;const a=new f(i);t.addEventListener("submit",c=>{var d;c.preventDefault(),t.classList.remove("validation-error"),(d=document.querySelector(".error"))==null||d.classList.add("hide"),setTimeout(()=>{var o;(o=document.querySelector(".error"))==null||o.remove()},200);const u=new FormData(t),r={};for(const o of u.entries())r[o[0]]=o[1];a.disable(),a.showLoader(),setTimeout(()=>{L(r,t,a)},400)})}async function L(n,e,t){fetch("https://hjort-backend.azurewebsites.net/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(async i=>{if(!i.ok)throw t.enable(),t.hideLoader(),await i.json();return i.json()}).then(i=>{t.enable(),t.hideLoader(),localStorage.setItem("token",i),window.location.replace("/hjort-cms/bokningar/")}).catch(i=>{b(i)?i.field==="login"?(e.classList.add("validation-error"),s(e,"Felaktigt användarnamn eller lösenord.")):i.field==="network"&&(e.classList.add("validation-error"),s(e,"Det uppstod ett nätverksfel. Försök igen senare.")):(e.classList.add("validation-error"),s(e,"Unexpected app error"))})}function S(){h(),m(),p()}S();
